clc
clear
x1 = [0 6 10 13 17 20 28];
ydados = [6.67 17.33 42.67 37.33 30.10 29.31 28.74];
ydados1 = [6.67 16.11 18.89 15.00 10.56 9.44 8.89];
x = 0:1:30;
%Construção do polinômio
a = ydados;
a1 = ydados1;
%-----------Denominador----------
w1 = (x1(1) - x1(2)).*(x1(1) - x1(3)).*(x1(1) - x1(4)).*(x1(1) - x1(5)).*(x1(1) -
x1(6)).*(x1(1) - x1(7));
w2 = (x1(2) - x1(1)).*(x1(2) - x1(3)).*(x1(2) - x1(4)).*(x1(2) - x1(5)).*(x1(2) -
x1(6)).*(x1(2) - x1(7));
w3 = (x1(3) - x1(1)).*(x1(3) - x1(2)).*(x1(3) - x1(4)).*(x1(3) - x1(5)).*(x1(3) -
x1(6)).*(x1(3) - x1(7));
w4 = (x1(4) - x1(1)).*(x1(4) - x1(2)).*(x1(4) - x1(3)).*(x1(4) - x1(5)).*(x1(4) -
x1(6)).*(x1(4) - x1(7));
w5 = (x1(5) - x1(1)).*(x1(5) - x1(2)).*(x1(5) - x1(3)).*(x1(5) - x1(4)).*(x1(5) -
x1(6)).*(x1(5) - x1(7));
w6 = (x1(6) - x1(1)).*(x1(6) - x1(2)).*(x1(6) - x1(3)).*(x1(6) - x1(4)).*(x1(6) -
x1(5)).*(x1(6) - x1(7));
w7 = (x1(7) - x1(1)).*(x1(7) - x1(2)).*(x1(7) - x1(3)).*(x1(7) - x1(4)).*(x1(7) -
x1(5)).*(x1(7) - x1(6));
%-----------Numerador-------------
w11 = (x - x1(2)).*(x - x1(3)).*(x - x1(4)).*(x - x1(5)).*(x - x1(6)).*(x - x1(7));
w22 = (x - x1(1)).*(x - x1(3)).*(x - x1(4)).*(x - x1(5)).*(x - x1(6)).*(x - x1(7));
w33 = (x - x1(1)).*(x - x1(2)).*(x - x1(4)).*(x - x1(5)).*(x - x1(6)).*(x - x1(7));
w44 = (x - x1(1)).*(x - x1(2)).*(x - x1(3)).*(x - x1(5)).*(x - x1(6)).*(x - x1(7));
w55 = (x - x1(1)).*(x - x1(2)).*(x - x1(3)).*(x - x1(4)).*(x - x1(6)).*(x - x1(7));
w66 = (x - x1(1)).*(x - x1(2)).*(x - x1(3)).*(x - x1(4)).*(x - x1(5)).*(x - x1(7));
w77 = (x - x1(1)).*(x - x1(2)).*(x - x1(3)).*(x - x1(4)).*(x - x1(5)).*(x - x1(6));
%-----------------L----------------
l1 = w11./w1;
l2 = w22./w2;
l3 = w33./w3;
l4 = w44./w4;
l5 = w55./w5;
l6 = w66./w6;
l7 = w77./w7;
%--------Por polinômio------------
y = (a(1)).*l1 + (a(2)).*l2 + (a(3)).*l3 + (a(4)).*l4 + (a(5)).*l5 + (a(6)).*l6 + (a(7)).*l7;
y1 = (a1(1)).*l1 + (a1(2)).*l2 + (a1(3)).*l3 + (a1(4)).*l4 + (a1(5)).*l5 + (a1(6)).*l6 + (a1(7)).*l7; 

%----------Gráfico de Lagrange----------
plot(x1,ydados,'ko',x1,ydados1,'mo')
hold on
plot(x,y,'m',x,y1,'k',grid)
axis([0 30 -50 50]);
legend({'Amostra 1','Amostra 2','Interpolação da amostra 1', 'Interpolação da amostra 2'},"location","south");
xlabel('Dia');
ylabel('Peso média (mg)')
